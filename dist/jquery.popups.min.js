/* jQuery Popups - v1.1.0 - 2014-08-22
 * https://github.com/harris-miller/Popups
 * Copyright (c) 2014 Harris Miller
 * Licensed MIT 
 */
+function(a,b,c){"use strict";function d(b){if(!b||!b[0])return{height:0,left:0,top:0,width:0};var c=b[0];return a.extend({},{width:c.offsetWidth,height:c.offsetHeight},b.offset())}function e(){return{height:l.height(),left:0,top:m.scrollTop(),width:l.width()}}function f(a,b){if(!a||!a.length)return 0;var c=this.placement,d=p.exec(b),e=a[0].offsetWidth,f=a[0].offsetHeight,g=0;return d||(d=p.exec("50%")),d&&d[1]&&(("right"===c||"left"===c)&&(g=f*(parseFloat(d[1])/100)),("top"===c||"bottom"===c)&&(g=e*(parseFloat(d[1])/100))),d&&d[2]&&(g+=parseFloat(d[2])),g}function g(){var b=this.options;b.boundary||0===b.boundary||(b.boundary="0"),a.isNumeric(b.boundary)&&(b.boundary=b.boundary.toString());var c,d=b.boundary.split(" ");if(d.length<1||d>4)return{top:0,right:0,bottom:0,left:0};for(c=0;c<d.length;c++)d[c]=parseFloat(d[c])||0;switch(d.length){case 4:return{top:d[0],right:d[1],bottom:d[2],left:d[3]};case 3:return{top:d[0],right:d[1],bottom:d[2],left:d[1]};case 2:return{top:d[0],right:d[1],bottom:d[0],left:d[1]};case 1:return{top:d[0],right:d[0],bottom:d[0],left:d[0]};default:return{top:0,right:0,bottom:0,left:0}}}function h(a){var b,c,d=0,e=a.css("transition-duration").split(", "),f=a.css("transition-delay").split(", ");for(b=0;b<e.length;b++)c=parseFloat(e[b])+parseFloat(f[b]),d=c>d?c:d;return 1e3*d+30}function i(){var a=b.createElement("popup"),c={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var d in c)if(void 0!==a.style[d])return{end:c[d]};return!1}var j,k,l=a(c),m=a(b),n=a(b.body),o=0,p=/^(?:\+?(\-?\d+(?:\.\d+)?%))?(?:\+?(\-?\d+(?:\.\d+)?)(?:px)?)?$/,q=/top|bottom|right|left|middle|free/,r=/top|bottom|middle/,s=/right|left|middle/,t=/flip/,u=/fit/,v=function(c,d){var e=d;this.options=e,this.$el=c,this.isShowing=!1,this.guid="popup"+ ++o,!k&&(e.animate=!1),"string"!=typeof e.placement&&(e.placement="free"),e.placement=e.placement.toLowerCase(),!q.test(e.placement)&&(e.placement="free"),this.placement=e.placement,e.within=a(e.within),0===e.within.length&&(e.within=l),this.$anchor=a(e.anchor),e.boundary=g.call(this),this.$popupContainer=a('<div class="popup-container">').addClass(e.classes),e.showArrow&&this.$popupContainer.addClass("show-arrow"),e.closeTemplate=e.closeTemplate||'<button class="popup-close" type="button"></button>',e.arrowTemplate=e.arrowTemplate||'<div class="popup-arrow"><div class="inner-arrow"></div></div>',this.$closeButton=e.showClose?a(e.closeTemplate).appendTo(this.$popupContainer):null,this.$arrow=e.showArrow?a(e.arrowTemplate).appendTo(this.$popupContainer):null,this.$closeButton&&this.$closeButton.on("click",a.proxy(this.hide,this)),e.container?a(e.container).append(c):a.contains(b.body,c.get(0))||n.append(c),c.after(this.$popupContainer),this.$popupContainer.append(c).hide(),e.animate&&this.$popupContainer.css("visibility","hidden"),this.$anchor&&this.$anchor.data("popup-ref",this.$el),l.on("resize."+this.guid,a.proxy(this.position,this)),c.trigger("create.popup"),e.autoShow&&this.show()};v.prototype.position=function(){if(this.isShowing){var a=this.placement,b=this.options,g=f.call(this,this.$popupContainer,b.offset),h=this.$popupContainer[0].offsetWidth,i=this.$popupContainer[0].offsetHeight,k=d(this.$anchor),n=f.call(this,this.$anchor,b.anchorPoint),o={top:null,left:null},p=b.within[0]===c,q=p?e():d(b.within);if("free"!==a&&"middle"!==a&&t.test(b.collision)){var v=[],w=!1,x=function(){return k.left+k.width+h>q.left+q.width-b.boundary.right?!1:"right"},y=function(){return k.left-h<q.left+b.boundary.left?!1:"left"},z=function(){return k.top+k.height+i>q.top+q.height-b.boundary.bottom?!1:"bottom"},A=function(){return k.top-i<q.top+b.boundary.top?!1:"top"};switch(a){case"right":v=[x,y];break;case"left":v=[y,x];break;case"bottom":v=[z,A];break;case"top":v=[A,z]}for(j=0;j<v.length&&(w=v[j](),w===!1);j++);w===!1&&(w="middle"),a=w}switch(this.$popupContainer.removeClass("top bottom right left middle free").addClass(a),a){case"top":o={top:k.top-i-parseFloat(this.$popupContainer.css("margin-bottom")),left:k.left+n-g};break;case"bottom":o={top:k.top+k.height+parseFloat(this.$popupContainer.css("margin-top")),left:k.left+n-g};break;case"right":o={top:k.top+n-g,left:k.left+k.width+parseFloat(this.$popupContainer.css("margin-left"))};break;case"left":o={top:k.top+n-g,left:k.left-h-parseFloat(this.$popupContainer.css("margin-right"))};break;case"middle":o={top:m.scrollTop()+l.height()/2-i/2,left:l.width()/2-h/2};break;default:a="free"}if(u.test(b.collision)){var B;r.test(a)&&(o.left+h>q.left+q.width-b.boundary.right&&(B=o.left+h-(q.left+q.width-b.boundary.right),o.left-=B,g+=B),o.left<q.left+b.boundary.left&&(B=-o.left+q.left+b.boundary.left,o.left+=B,g-=B)),s.test(a)&&(o.top+i>q.top+q.height-b.boundary.bottom&&(B=o.top+i-(q.top+q.height-b.boundary.bottom),o.top-=B,g+=B),o.top<q.top+b.boundary.top&&(B=q.top-o.top+b.boundary.top,o.top+=B,g-=B))}if(this.$popupContainer.offset(o),b.showArrow){var C=this.$arrow,D={top:null,left:null},E=parseFloat(this.$popupContainer.css("border-top-width")),F=parseFloat(this.$popupContainer.css("border-left-width"));switch(C.css({left:"",right:"",top:"",bottom:""}),a){case"top":D={bottom:-C.outerHeight(),left:-C.outerWidth()/2+g-F};break;case"bottom":D={top:-C.outerHeight(),left:-C.outerWidth()/2+g-F};break;case"right":D={top:-C.outerHeight()/2+g-E,left:-C.outerWidth()};break;case"left":D={top:-C.outerHeight()/2+g-E,right:-C.outerWidth()}}C.css(D)}return this.$el.trigger("positioned.popup"),a}},v.prototype.show=function(){function a(){b.$popupContainer.addClass("showing"),b.$el.trigger("shown.popup")}var b=this;this.isShowing||(this.isShowing=!0,this.$el.trigger("show.popup"),this.$popupContainer.show(),this.position(),this.options.animate?this.$popupContainer.addClass("ani-start").css("visibility","visible").delay(30).queue(function(a){b.$popupContainer.addClass("ani-show"),a()}).delay(30).queue(function(d){b.$popupContainer.removeClass("ani-start"),c.setTimeout(function(){b.$popupContainer.removeClass("ani-show"),a()},h(b.$popupContainer)),d()}):a())},v.prototype.hide=function(){function a(){b.isShowing=!1,b.$popupContainer.hide(),b.$el.trigger("hidden.popup"),b.options.destroyOnHide&&b.destroy()}var b=this;this.options.jqXHR&&"pending"===this.options.jqXHR.state()&&(this.options.jqXHR.abort(),this.destroy()),this.isShowing&&(this.$el.trigger("hide.popup"),this.$popupContainer.removeClass("showing"),this.options.animate?this.$popupContainer.addClass("ani-hide").delay(30).queue(function(d){b.$popupContainer.addClass("ani-end"),c.setTimeout(function(){b.$popupContainer.removeClass("ani-hide ani-end").css("visibility","hidden"),a()},h(b.$popupContainer)),d()}):a())},v.prototype.toggle=function(){this.isShowing?this.hide():this.show()},v.prototype.destroy=function(){this.$anchor&&this.$anchor.removeData("popup-ref"),l.off("resize."+this.guid),this.$el.off(".popup"),this.$el.trigger("destroy.popup"),this.$popupContainer.remove()},v.prototype.setContent=function(a){this.$el.empty().append(a),this.position()};var w=a.fn.popup;a.fn.popup=function(b,c){var d;return this.each(function(){var e=a(this),f=e.data("popup");if(this.readyState&&this.promise){b.jqXHR=this,b.loadingTemplate=b.loadingTemplate||'<div class="popup-inner">';var g=a(b.loadingTemplate).popup(b);return g.popup("$popupContainer").addClass("loading"),this.always(function(){g.popup("$popupContainer").removeClass("loading")}),d=g,!1}if(f)if("string"==typeof b){if(b in f&&(d=a.isFunction(f[b])?f[b](c):f[b]),void 0!==d)return!1}else!b||a.isPlainObject(b)?f.toggle():a.error("fn.popup says: Method or Property you are trying to access does not exist");else b=a.extend({},a.fn.popup.defaults,a.isPlainObject(b)&&b,e.data()),e.data("popup",f=new v(e,b))}),void 0!==d?d:this},a.popup=function(b,c){var d=a(b).first();return 0===d.length?(a.error("fn.popup says: selector returned zero results"),d):d.popup(c)},a.fn.popup.Constructor=v,a.fn.popup.defaults={animate:!1,anchor:null,anchorPoint:"50%",arrowTemplate:null,autoShow:!0,boundary:"0",classes:null,closeTempalte:null,collision:"flip",container:null,destroyOnHide:!1,loadingTemplate:null,offset:"50%",placement:"right",showArrow:!1,showClose:!1,within:l},a.fn.popup.noConflict=function(){return a.fn.popup=w,this},a(function(){k=i()})}(jQuery,document,window);